<div class="max-w-2xl space-y-8">
  <div>
    <h1 class="text-[22px] font-semibold tracking-tight" style="color: #1A1A1A;">MCP Setup Guide</h1>
    <p class="mt-2 text-[15px]" style="color: #6B6760;">Connect Claude or other AI assistants to your errors using the Model Context Protocol.</p>
  </div>

  <!-- Step 1 -->
  <div class="space-y-4">
    <div class="flex items-center gap-3">
      <span class="flex items-center justify-center w-7 h-7 rounded-full text-[13px] font-semibold" style="background: #1A1A1A; color: #FFFFFE;">1</span>
      <h2 class="text-[16px] font-medium" style="color: #1A1A1A;">Get your API key</h2>
    </div>
    <p class="text-[14px]" style="color: #6B6760;">Use this API key to authenticate MCP requests:</p>
    <div class="group" style="position: relative;" data-controller="clipboard">
      <pre class="px-5 py-4 rounded-xl text-[13px] font-mono overflow-x-auto" style="background: #1A1A1A; color: #E8E5E0;"><code><%= session[:api_key] %></code></pre>
      <button data-action="click->clipboard#copy" data-clipboard-target="source"
              data-copy="<%= session[:api_key] %>"
              class="px-3 py-1.5 text-[12px] font-medium rounded-md transition-all opacity-0 group-hover:opacity-100"
              style="position: absolute; top: 12px; right: 12px; background: #3A3A3A; color: #E8E5E0; border: 1px solid #4A4A4A;">
        Copy
      </button>
    </div>
  </div>

  <!-- Step 2 -->
  <div class="space-y-4">
    <div class="flex items-center gap-3">
      <span class="flex items-center justify-center w-7 h-7 rounded-full text-[13px] font-semibold" style="background: #1A1A1A; color: #FFFFFE;">2</span>
      <h2 class="text-[16px] font-medium" style="color: #1A1A1A;">Configure Claude Code</h2>
    </div>
    <p class="text-[14px]" style="color: #6B6760;">Add Reflex as an MCP server in your Claude Code settings:</p>
    <div class="group" style="position: relative;" data-controller="clipboard">
      <pre class="px-5 py-4 rounded-xl text-[13px] font-mono overflow-x-auto" style="background: #1A1A1A; color: #E8E5E0;"><code>{
  "mcpServers": {
    "reflex": {
      "url": "<%= request.base_url %>/mcp/rpc",
      "headers": {
        "Authorization": "Bearer <%= session[:api_key] %>"
      }
    }
  }
}</code></pre>
      <button data-action="click->clipboard#copy" data-clipboard-target="source"
              data-copy='{"mcpServers":{"reflex":{"url":"<%= request.base_url %>/mcp/rpc","headers":{"Authorization":"Bearer <%= session[:api_key] %>"}}}}'
              class="px-3 py-1.5 text-[12px] font-medium rounded-md transition-all opacity-0 group-hover:opacity-100"
              style="position: absolute; top: 12px; right: 12px; background: #3A3A3A; color: #E8E5E0; border: 1px solid #4A4A4A;">
        Copy
      </button>
    </div>
    <p class="text-[14px]" style="color: #8B8780;">Add this to <code class="px-1.5 py-0.5 rounded text-[13px]" style="background: #F5F3F0;">~/.claude/settings.json</code> or your project's <code class="px-1.5 py-0.5 rounded text-[13px]" style="background: #F5F3F0;">.claude/settings.json</code></p>
  </div>

  <!-- Step 3 -->
  <div class="space-y-4">
    <div class="flex items-center gap-3">
      <span class="flex items-center justify-center w-7 h-7 rounded-full text-[13px] font-semibold" style="background: #1A1A1A; color: #FFFFFE;">3</span>
      <h2 class="text-[16px] font-medium" style="color: #1A1A1A;">Start using Reflex with Claude</h2>
    </div>
    <p class="text-[14px]" style="color: #6B6760;">Once configured, Claude can query and manage your errors directly. Try asking:</p>
    <div class="space-y-3 mt-4">
      <div class="px-4 py-3 rounded-lg" style="background: #F5F3F0; border: 1px solid #E8E5E0;">
        <p class="text-[14px] font-medium" style="color: #1A1A1A;">"Show me unresolved errors"</p>
      </div>
      <div class="px-4 py-3 rounded-lg" style="background: #F5F3F0; border: 1px solid #E8E5E0;">
        <p class="text-[14px] font-medium" style="color: #1A1A1A;">"What errors happened today?"</p>
      </div>
      <div class="px-4 py-3 rounded-lg" style="background: #F5F3F0; border: 1px solid #E8E5E0;">
        <p class="text-[14px] font-medium" style="color: #1A1A1A;">"Resolve the NoMethodError in users_controller"</p>
      </div>
    </div>
  </div>

  <!-- Available Tools -->
  <div class="pt-6" style="border-top: 1px solid #E8E5E0;">
    <h3 class="text-[15px] font-medium mb-4" style="color: #1A1A1A;">Available MCP tools</h3>
    <div class="space-y-3">
      <div class="flex items-start gap-3">
        <code class="px-2 py-1 rounded text-[12px] font-mono shrink-0" style="background: #EFF6FF; color: #1D4ED8; border: 1px solid #BFDBFE;">reflex_list</code>
        <p class="text-[13px]" style="color: #6B6760;">List errors with filtering by status, sorted by recent or frequent</p>
      </div>
      <div class="flex items-start gap-3">
        <code class="px-2 py-1 rounded text-[12px] font-mono shrink-0" style="background: #F5F3F0; color: #6B6760; border: 1px solid #E8E5E0;">reflex_show</code>
        <p class="text-[13px]" style="color: #6B6760;">Get error details including full backtrace and context</p>
      </div>
      <div class="flex items-start gap-3">
        <code class="px-2 py-1 rounded text-[12px] font-mono shrink-0" style="background: #ECFDF5; color: #059669; border: 1px solid #A7F3D0;">reflex_resolve</code>
        <p class="text-[13px]" style="color: #6B6760;">Mark an error as resolved</p>
      </div>
      <div class="flex items-start gap-3">
        <code class="px-2 py-1 rounded text-[12px] font-mono shrink-0" style="background: #FFFBEB; color: #B45309; border: 1px solid #FDE68A;">reflex_ignore</code>
        <p class="text-[13px]" style="color: #6B6760;">Ignore an error (won't trigger alerts)</p>
      </div>
      <div class="flex items-start gap-3">
        <code class="px-2 py-1 rounded text-[12px] font-mono shrink-0" style="background: #FEF2F2; color: #DC2626; border: 1px solid #FECACA;">reflex_unresolve</code>
        <p class="text-[13px]" style="color: #6B6760;">Reopen a previously resolved error</p>
      </div>
      <div class="flex items-start gap-3">
        <code class="px-2 py-1 rounded text-[12px] font-mono shrink-0" style="background: #F3E8FF; color: #7C3AED; border: 1px solid #DDD6FE;">reflex_stats</code>
        <p class="text-[13px]" style="color: #6B6760;">Get error statistics and trends</p>
      </div>
      <div class="flex items-start gap-3">
        <code class="px-2 py-1 rounded text-[12px] font-mono shrink-0" style="background: #FEF3C7; color: #92400E; border: 1px solid #FDE68A;">reflex_search</code>
        <p class="text-[13px]" style="color: #6B6760;">Search errors by class, user, commit, or message</p>
      </div>
    </div>
  </div>

  <!-- Example workflows -->
  <div class="pt-6" style="border-top: 1px solid #E8E5E0;">
    <h3 class="text-[15px] font-medium mb-4" style="color: #1A1A1A;">Example workflows</h3>
    <div class="space-y-4">
      <div class="px-4 py-3 rounded-lg" style="background: #F0FDF4; border: 1px solid #BBF7D0;">
        <p class="text-[13px] font-medium" style="color: #166534;">Triage new errors</p>
        <p class="text-[12px] mt-1" style="color: #166534;">"List the 5 most recent unresolved errors and show me the backtrace for each"</p>
      </div>
      <div class="px-4 py-3 rounded-lg" style="background: #FEF2F2; border: 1px solid #FECACA;">
        <p class="text-[13px] font-medium" style="color: #991B1B;">Investigate a specific error</p>
        <p class="text-[12px] mt-1" style="color: #991B1B;">"Show me details for the ActiveRecord::RecordNotFound error and suggest a fix"</p>
      </div>
      <div class="px-4 py-3 rounded-lg" style="background: #EFF6FF; border: 1px solid #BFDBFE;">
        <p class="text-[13px] font-medium" style="color: #1D4ED8;">Bulk resolve</p>
        <p class="text-[12px] mt-1" style="color: #1D4ED8;">"Find all errors related to the payments feature and resolve them"</p>
      </div>
    </div>
  </div>

  <!-- Test it -->
  <div class="space-y-4">
    <h3 class="text-[15px] font-medium" style="color: #1A1A1A;">Test MCP connection</h3>
    <p class="text-[14px]" style="color: #6B6760;">List available tools with curl:</p>
    <div class="group" style="position: relative;" data-controller="clipboard">
      <pre class="px-5 py-4 rounded-xl text-[13px] font-mono overflow-x-auto" style="background: #1A1A1A; color: #E8E5E0;"><code>curl <%= request.base_url %>/mcp/tools \
  -H "Authorization: Bearer <%= session[:api_key] %>"</code></pre>
      <button data-action="click->clipboard#copy" data-clipboard-target="source"
              data-copy="curl <%= request.base_url %>/mcp/tools -H &quot;Authorization: Bearer <%= session[:api_key] %>&quot;"
              class="px-3 py-1.5 text-[12px] font-medium rounded-md transition-all opacity-0 group-hover:opacity-100"
              style="position: absolute; top: 12px; right: 12px; background: #3A3A3A; color: #E8E5E0; border: 1px solid #4A4A4A;">
        Copy
      </button>
    </div>
  </div>
</div>
